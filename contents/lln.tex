Neka se vrši jednostavni eksperiment bacanja novčića i posmatra ishod koji može
biti "glava" ili "pismo". Intuitivno je da će oba ishoda imati jednaku
vjerovatnoću. Kako se može opravdati ta intuicija?

Postoji problem u tome što je moguće da se pri (nekom fiksnom) velikom broju
bacanja svaki put pojavi glava. Štaviše, neizbježno je da će se prilikom
izvođenja eksperimenta pojavljivati intervali u kojima se isti ishodi javljaju
zaredom. Pitanja vezana za ponašanje eksperimenata koji se izvode veliki broj
puta će biti razjašnjena u ovom poglavlju. Razmatranje će biti provedeno
formalno, korištenjem pojma slučajne sekvence i definiranjem ostalih relevantnih
pojmova. Zaključak će biti formulisan u vidu zakona velikih brojeva (engl.
\textit{law of large numbers -- LLN})

\subsection{Konvergencija slučajnih sekvenci}

Ako su $X_i$, $i=1,2,...$ slučajne varijable, onda se sa $\{X_n\}$ označava
\textit{slučajna sekvenca (proces)}. Razlika između slučajne sekvence i
determinističke sekvence jeste u tome što vrijednost sekvence zavisi od ishoda
nekog eksperimenta.  Ako je $\Omega$ skup svih ishoda nekog eksperimenta, onda
se slučajna sekvenca može zapisati kao $\{X_n(\omega)\}$, pri čemu $\omega \in
\Omega$. Ovaj posljednji zapis će se često koristiti u ostatku poglavlja. Bitno
je primijetiti da sekvenca $X_n(\omega)$ za svaku konkretnu (poznatu) vrijednost
$\omega$ predstavlja determinističku sekvencu, koja se naziva
\textit{realizacija slučajne sekvence}.

Kao u slučaju determinističkih sekvenci, od interesa je posmatrati ponašanje
slučajnih sekvenci (procesa) u beskonačnosti. Međutim, kod slučajnih sekvenci
postoji više različitih pojmova konvergencije. U ovom poglavlju će biti uvedene
neke od njih. 

\begin{definition}[Konvergencija svuda]
  Za slučajnu sekvencu $\{X_n\}$ se kaže da konvergira svuda (sigurno) ka
  slučajnoj varijabli $X$ ako je
  \begin{equation}
    \lim_{n\to\infty} X_n(\omega) = X(\omega)
  \end{equation}
  za svako $\omega \in \Omega$.
\end{definition}

% Primjer TODO rm
%\begin{exmp}
%  Neka je data slučajna sekvenca $X_n(\omega) = \omega^n$, pri čemu je
%  eksperiment opisan uniformnom funkcijom gustine raspodjele $p(\omega)$ na
%  intervalu $[0, 0.5]$, koji se podudara sa skupom ishoda $\Omega$. Ispitati
%  sigurnu konvergenciju sekvence $X_n$.
%\end{exmp}

%Jednostavno se zaključuje da je
%\begin{equation}
%  \lim_{n\to\infty} X_n(\omega)
%  = \lim_{n\to\infty} \omega^n = 0,\ \forall \omega \in \Omega
%\end{equation}

%Dakle, sekvenca $X_n(\omega)$ konvergira svuda ka $X=0$. U ovom
%primjeru sekvenca konvergira ka istom broju za svaku vrijednost $\omega$, tj.
%nezavisno od ishoda eksperimenta.

% Primjer
\begin{exmp}
  Neka je slučajna sekvenca $X_n(\omega) = \frac{\omega n}{n+1}$, $\omega \in
  \Omega = \mathbb{R}$. Ispitati sigurnu konvergenciju.
\end{exmp}

Vrijedi
\begin{equation}
  \lim_{n\to\infty} X_n(\omega) = \omega \lim_{n\to\infty}\frac{n}{n+1} = \omega
\end{equation}

Dakle, sekvenca $X_n(\omega)$ konvergira ka slučajnoj varijabli $X(\omega) =
\omega$ za $\forall \omega\in\Omega$.  Međutim granična vrijednost zavisi od
$\omega$, tj. od ishoda eksperimenta, što je opisano slučajnom varijablom $X$.

\begin{exmp} \label{ex:converge-surely}
  Neka je $X_n(\omega) = \omega^n$, pri čemu je $\Omega= \mathbb{R}$ eksperiment
  opisan uniformnom PDF:
  $$p(\omega) = 1_{[0,1]}(\omega) = \begin{cases}
      1, \omega \in [0,1]\ \\ 0,\ \text{\normalfont inače}
    \end{cases}
  $$
  Ispitati sigurnu konvergenciju sekvence $X_n$.
\end{exmp}

Jasno je da sekvenca $\omega^n$ konvergira ka $X=0$ za $\omega \in [0,1)$, te ka
$X=1$ za $\omega = 1$. Međutim, za sve ostale vrijednosti $\omega$, sekvenca
divergira. Dakle, sekvenca $X_n$ ne konvergira svuda.\\

Konvergencija svuda u praksi često nije potrebna. Na primjer, nije od
velikog interesa da li će sekvenca $X_n$ iz prethodnog primjera konvergirati za
$\omega \in \mathbb{R}\setminus[0,1]$, jer je taj događaj nemoguć. Zato se uvodi
pojam konvergencije skoro svuda.

\begin{definition}[Konvergencija skoro svuda]
  Za slučajnu sekvencu $\{X_n\}$ se kaže da konvergira skoro svuda (skoro
  sigurno, ili sa vjerovatnoćom 1) ka slučajnoj varijabli $X$ ako je
  \begin{equation}
    \lim_{n\to\infty} X_n(\omega) = X(\omega)
  \end{equation}
  za svako $\omega$ iz nekog skupa $\Lambda$ za koji vrijedi
  $\pr(\omega\in\Lambda)=1$.
\end{definition}

Sekvenca iz primjera \ref{ex:converge-surely} konvergira skoro sigurno jer
sekvenca konvergira za $\forall \omega \in \Lambda = [0,1]$, pri čemu je
$\pr(\omega \in [0,1]) = 1$.

\begin{definition}[Konvergencija po vjerovatnoći]
  Za slučajnu sekvencu $\{X_n\}$ se kaže da konvergira po vjerovatnoći ka
  slučajnoj varijabli $X$ ako za svako fiksno $\varepsilon > 0$ vrijedi
  \footnote{
    Ovaj uslov se često (ekvivalentno) navodi kao
    $\lim_{n\to\infty} \pr(|X_n-X|>\varepsilon) = 0$
  }
  \begin{equation}
    \lim_{n\to\infty} \pr\left(|X_n - X| \le \varepsilon\right) = 1
  \end{equation}
\end{definition}

Grubo rečeno, sekvenca koja konvergira po vjerovatnoći je takva da relativno
veliki broj realizacija sekvence dovoljno dobro aproksimira slučajnu varijablu
$X$ u beskonačnosti. Ekvivalentno, to znači da relativno mali broj realizacija
nedovoljno dobro aproksimira slučajnu varijablu $X$ u beskonačnosti. Pojam
\textit{dovoljno dobro} ovdje znači u odnosu na odabrano $\varepsilon$. Iz skoro
sigurne konvergencije slijedi konvergencija po vjerovatnoći, dok obrat ne važi.
Intuitivno, konvergencija po vjerovatnoći znači "Svaka realizacija vjerovatno
konvergira", dok konvergencija skoro svuda znači "Praktično je sigurno da svaka
realizacija konvergira". \\

Prethodne definicije su potrebne za formulaciju zakona velikih brojeva, dok će
sljedeća definicija biti od koristi za centralni granični teorem.  U nastavku će
sa $P_X(x)$ biti označena funkcija raspodjele vjerovatnoće slučajne varijable
$X$.

\begin{definition}[Konvergencija po distribuciji]
  Za slučajnu sekvencu $\{X_n\}$ se kaže da konvergira po raspodjeli ka
  slučajnoj varijabli $X$ ako je
  \begin{equation}
    \lim_{n\to\infty} P_{X_n}(x) = P_X(x)
  \end{equation}
  u svakoj tački $x$ u kojoj je funkcija $P_X$ neprekidna.
\end{definition}

Korisno je istaknuti da su svi prethodni konvergencije navedeni od najstrožijeg
ka najblažem.

\begin{definition}[Srednja vrijednost uzorka]

  Neka je $\{X_n\}$ slučajna sekvenca. Slučajna varijabla $S_n$
  definirana kao 
  \begin{equation} \label{eq:sample-mean}
    S_n = \frac{1}{n} \sum_{i=1}^{n} X_i
  \end{equation}
  se naziva srednja vrijednost uzorka $X_1,X_2,...,X_n$.

\end{definition}
%
Sljedeća pitanja su od praktičnog interesa:

\begin{itemize}
  \item Ponašanje empirijski dobivene srednje vrijednosti $S_n$, eventualna
    konvergencija i na koji način konvergencija zavisi od sekvence $\{X_n\}$.
  \item Statističke osobine malih varijacija sekvence $S_n$ oko srednje
    vrijednosti.\footnote{Često su od interesa su i statističke osobine velikih
    varijacija oko srednje vrijednosti, što neće biti razmatrano u ovom radu.}
    Drugim riječima, od interesa je kakav će biti oblik raspodjele sekvence $S_n$.
\end{itemize}

Odgovor na prvo pitanje daju zakoni velikih brojeva, dok odgovor na drugo
pitanje daje centralni granični teorem koji će biti obrađen u sljedećem
poglavlju.

\subsection{Formulacija zakona velikih brojeva}%

 U literaturi se najčešće susreću dva zakona velikih brojeva: slabi i
jaki. Dodatno, oba zakona se susreću u više verzija. U nastavku će ovi zakoni
biti formulisani način koji najbolje ilustruje razliku između njih.

\begin{theorem}[Slabi zakon velikih brojeva]
  Neka je $\{X_n\}$ sekvenca slučajnih varijabli sa očekivanjem $\mu$ i
  ograničenom varijansom $\sigma_n^2 \le \sigma^2 < \infty$ i neka je $\{S_n\}$
  sekvenca srednjih vrijednosti uzoraka. Tada za svako $\varepsilon>0$
  \begin{equation}
    \lim_{n\to\infty} \pr(|S_n - \mu| \le \varepsilon) = 1
  \end{equation}
  Drugim riječima, sekvenca $\{S_n\}$ konvergira ka $\mu$ po vjerovatnoći.
\end{theorem}

Druga verzija ovog teorema koja se češće susreće u literaturi je manje općenita,
a razlikuje se od prethodne u tome što se za $\{S_n\}$ pretpostavlja da je IID.
Jedan heuristički dokaz ovog teorema će biti dat u poglavlju \ref{sec:clt-lln}.

\begin{theorem}[Jaki zakon velikih brojeva]
  Neka je $\{X_n\}$ sekvenca IID slučajnih varijabli sa očekivanjem $\mu$ i
  konačnom varijansom. Tada sekvenca $\{S_n\}$ srednjih vrijednosti uzoraka
  konvergira skoro sigurno ka $\mu$.
\end{theorem}

Postoji i uslov koji garantuje važenje ovog teorema za sekvence koje nisu
identično distribuirane, ali se ovdje neće razmatrati. Bitno je napomenuti da
jaki zakon velikih brojeva implicira slabi zakon velikih brojeva. \\

Sada će prethodni koncepti biti ilustrirani kroz primjer. Slučajna sekvenca se
može predstaviti kao niz nizova (matrica), pri čemu svaki red predstavlja jednu
realizaciju slučajne sekvence. Izvršeno je kompjutersko generisanje (simulacija)
nekoliko nezavisnih sekvenci $X_n$ iz normalne raspodjele sa očekivanjem $\mu=0$
i standardnom devijacijom $\sigma$ koja se razlikuje za svaki slučaj.  Zatim je
za svaku sekvencu $X_n$ formirana sekvenca $S_n$. Na slikama \ref{fig:lln} su
prikazani rezultati ove simulacije za nekoliko karakterističnih slučajeva.
Različite sekvence su predstavljene različitim bojama.

Na slici \ref{fig:lln:a} su predstavljene 3 realizacije slučajne sekvence sa
standardnom devijacijom $\sigma=1$. Na ovom primjeru se jasno vidi da da
sekvenca sa povećanjem $n$ teži ka matematičkom očekivanju koje iznosi $\mu=0$.
Na slici \ref{fig:lln:b} su prikazane 3 realizacije za slučaj devijacije
$\sigma=2$. Ovdje se jasno vidi da je konvergencija sporija nego u prvom
slučaju. Međutim, predstavljeni grafici su namjenski podešeni tako da na prvi
pogled budu intuitivni. Može se desiti, na primjer, da sekvenca za male
vrijednosti $n$ bude jako bliska očekivanju $\mu$, pa da u nekom intervalu
"igrom slučaja" krene odstupati od očekivane vrijednosti (što je razmatrano u
uvodu ovog poglavlja). No, intuitivno je da ovakvi događaji imaju jako malu
vjerovatnoću.

Dalje, na slici \ref{fig:lln:c} je prikazano 50 realizacija sekvence za
$\sigma=2$. Gledajući ovako veliki broj realizacija, moguće je intuitivno
procijeniti ponašanje standardne devijacije sekvence, što će biti formalno
razjašnjeno u poglavlju \ref{sec:clt}. Na ovom primjeru se može ilustrirati
razlika između slabog i jakog zakona velikih brojeva. Naime, posmatrajući sliku
\ref{fig:lln:c} se može primijetiti da se funkcija gustine raspodjele sužava sa
povećanjem $n$. Međutim, ipak se može primijetiti postojanje nekih
realizacija koje odstupaju. Slabi zakon velikih brojeva garantuje da će se
vjerovatnoća postojanja ovakvih odstupanja smanjivati u beskonačnosti, što ne
znači da će sigurno sve realizacije konvergirati.  S druge strane, jaki zakon
velikih brojeva garantuje da će skoro sve realizacije konvergirati ka $\mu$.

Slika \ref{fig:lln:d} prikazuje slučaj kada se standardna devijacija sekvence
$X_n$ mijenja u zavisnosti od $n$. Konkretno, u ovom slučaju je $\sigma_n =
0.1n$, što divergira. Sa slike se vidi da će i sekvenca $S_n$ divergirati. Bitno
je napomenuti da u skladu sa slabim zakonom velikih brojeva, sekvenca $S_n$ bi
konvergirala da je niz standardnih devijacija $\sigma_n$ bio konvergentan.

\begin{figure}[H]
  \centering
    \fig{0.4}{lln_demo_1}{3 realizacije, $\sigma=1$}{fig:lln:a}
    \fig{0.4}{lln_demo_2}{3 realizacije, $\sigma=2$}{fig:lln:b}
    \fig{0.4}{lln_demo_3}{50 realizacija, $\sigma=2$}{fig:lln:c}
    \fig{0.4}{lln_demo_4}{5 realizacija, $\sigma_n=0.1n$}{fig:lln:d}
	\caption{Simulacija zakona velikih brojeva na slučajnoj sekvenci sa $\mu=0$}
  \label{fig:lln}
\end{figure}

Za kraj je korisno razmotriti jedan specijalan slučaj primjene zakona velikih
brojeva. \\

Neka se eksperiment $A$ sastoji u bacanju novčića, pri čemu vjerovatnoća ishoda
"glava" iznosi $p$, a vjerovatnoća ishoda $pismo$ iznosi $q$. Izvođenjem tog
eksperimenta više puta dobiva se novi eksperiment $B$. Nad skupom ishoda tog
eksperimenta se može definirati \textit{binarna} slučajna sekvenca $\{X_n\}$.
Ovdje će biti uzeto da takva sekvenca uzima vrijednost $X_n=1$, ako je ishod
$n$-tog bacanja bio glava, a $X_n=0$ u suprotnom. Bitno je razumjeti da skup
ishoda eksperimenta $B$ nije skup $\{\text{"glava"}=G, \text{"pismo"}=P\}$, nego
skup sekvenci koje mogu imati vrijednost G ili P. Na primjer, jedna takva
sekvenca je GPPGGPG....

Neka je od posebnog interesa za neki konkretan broj bacanja $n$ odrediti broj
bacanja $K_n$ u kojima je ishod bio glava ($X_i=1$). $\{K_n\}$ je također
slučajna sekvenca za koju se lako uočava da je\footnote{Pošto $X_i$ mogu uzeti
samo vrijednosti 0 ili 1, njihova suma je jednaka broju njih koji su jednaki 1}

\begin{equation}
  K_n = \sum_{i=1}^{n} X_i 
\end{equation}
%
Pokazuje se da će sekvenca $K_n$ imati masenu funkciju vjerovatnoće
\begin{equation}
  p_{K_n}(k) = \binom{n}{k} p^k q^{n-k}
\end{equation}
%
Ovo će biti pokazano u poglavlju \ref{sec:clt-suma}. Takva raspodjela se naziva
\textit{binomna}. Također se pokazuje da će ova sekvenca imati očekivanu
vrijednost $\mu_{K_n}=np$.

Sada se može se definirati sekvenca srednjih vrijednosti uzoraka za sekvencu
$\{X_n\}$, kao $S_n = K_n / n$. Svaka konkretna vrijednost $S_n$ predstavlja
\textit{relativnu frekvenciju} ishoda "glava" u $n$ bacanja novčića. Na osnovu
zakona velikih brojeva, sekvenca $S_n$ će konvergirati ka $\mu = \mu_{K_n}/n =
p$.  Intuitivno, to znači da će relativna frekvencija ishoda "glava" u velikom
broju bacanja težiti vjerovatnoći pojave glave u jednom bacanju.

\subsection{Praktična primjena}

Prethodni primjer se može generalizirati na sljedeći način, koji je za praksu
izuzetno važan. Neka je $X_n$ IID slučajna sekvenca koja može uzeti bilo koju
vrijednost iz nekog diskretnog skupa $\chi$, opisana masenom funkcijom
vjerovatnoće $p_{X}(x)$. Ova sekvenca jednoznačno opisuje ishod nekog
eksperimenta. Taj eksperiment može biti na primjer niz nekih mjerenja.

Neka se sada posmatra događaj $A:\{X=a\}$ i neka sekvenca $\{Y_{A,n}\}$ uzima
vrijednost 1 ako je u $n$-tom eksperimentu nastupio događaj $A$, te vrijednost 0
u suprotnom. Riječima, događaj $A$ se može iskazati kao "Prilikom $n$-tog
mjerenja je izmjerena vrijednost $a$". Ovaj događaj ima vjerovatnoću
$p_A=p_X(a)$. Jasno je da njemu komplementaran događaj ima vjerovatnoću
$q_A=1-p_A$. Za događaj $A$ se može definirati sekvenca

\begin{equation}
    S_{A,n} = \frac{1}{n}\sum_{i=1}^{n} Y_{A,i}
\end{equation}
%
koja predstavlja relativnu frekvenciju događaja $A$ prilikom $n$ izvođenja
eksperimenta. Na osnovu prethodnog razmatranja, sekvenca $S_{A,n}$ konvergira ka
$p_A$.

Ovaj rezultat se može interpretirati na sljedeći način. Za svaki mogući događaj
$A$ koji može nastupiti u eksperimentu se nađe njegova relativna frekvencija u
$n$ izvođenja eksperimenta. Na taj način je dobiven \textit{histogram} za
sekvencu $X_n$ (koji je normalizovan, tj. podijeljen sa $n$). Ako se eksperiment
izvrši veliki broj puta, ovaj normalizovani histogram će konvergirati ka masenoj
funkciji vjerovatnoće $p_X(x)$. \\

Ovo se jednostavno generalizuje za sekvence koje uzimaju realne vrijednosti.
Naime, skup vrijednosti neke IID sekvence $X_n$ se može uniformno podijeliti na
podintervale $A$ koji predstavljaju događaje.\footnote{Preciznije bi bilo pisati
$A_k$, jer je ovo zapravo niz skupova.} Konkretno za slučaj mjerenja, događaj
$A$ nastupa kada izmjerena vrijednost pripada tom intervalu $A$. Za svaki
događaj $A$ se može odrediti njegova vjerovatnoća nastupanja u jednom
eksperimentu na osnovu raspodjele sekvence $X_n$. Ova vjerovatnoća se može
označiti sa $p_A$. Slično kao i ranije, vrijedi se da će relativna frekvencija
događaja $A$ u $n$ izvođenja eksperimenta konvergirati ka $p_A$.

I u ovom slučaju je dobiven histogram sekvence $X_n$. Naime, intervali $A$ se
mogu posmatrati kao korpe u koje se ubacuju loptice kad god ishod eksperimenta
pripada tom intervalu. Ako se broj loptica u korpi $A$ podijeli sa brojem
eksperimenata, dobiva se relativna frekvencija događaja $A$.  Usitnjavanjem
intervala $A$, te povećanjem broja eksperimenata, ovako dobiven histogram
(dodatno podijeljen sa širinom intervala) sve bolje i bolje aproksimira funkciju
gustine raspodjele sekvence $X_n$. Ovaj zaključak je ilustriran na slikama
\ref{fig:lln-hist}, koja prikazuje PDF neke normalne slučajne sekvence, kao i
histogram kompjuterski generisane sekvence iz te raspodjele. $N$ predstavlja
veličinu generisanog uzorka sekvence, dok $k$ predstavlja broj intervala
histograma.

\begin{figure}[H]
  \centering
    \fig{0.31}{lln_hist_1}{$N=100$, $k=10$}{fig:lln-hist:a}
    \fig{0.31}{lln_hist_2}{$N=1000$, $k=30$}{fig:lln-hist:b}
    \fig{0.31}{lln_hist_3}{$N=10000$, $k=80$}{fig:lln-hist:c}
  \caption{Ilustracija konvergencije histograma ka PDF na simuliranoj slučajnoj
  sekvenci}
  \label{fig:lln-hist}
\end{figure}

Ovaj princip se primjenjuje, na primjer, kad god je potrebno na osnovu nekih
mjerenja procijeniti raspodjelu mjerene veličine.

\newcommand*{\vecrow}[2]{\left[\begin{array}{cc}#1&#2\end{array}\right]}
\newcommand*{\veccol}[2]{\left[\begin{array}{c}#1\\#2\end{array}\right]}

\subsection{Funkcija gustine vjerovatnoće}

Normalna (Gaussova) raspodjela je opisana funkcijom gustine raspodjele
vjerovatnoće (PDF):

\begin{equation} \label{eq:normal}
  p(x) = \frac{1}{\sqrt{2\pi\sigma^2}} e^{-\frac{(x-\mu)^2}{2\sigma^2}}
\end{equation}

Ako je slučajna varijabla opisana normalnom raspodjelom, kaže se da je normalno
raspodijeljena i piše se $X \sim \mathcal{N}(\mu,\sigma^2)$ Ovakva slučajna
varijabla se često naziva Gaussovom. Gaussova slučajna varijabla ima očekivanu
vrijednost $\mu$ i varijansu $\sigma^2$ (tj. standardnu devijaciju
$\sigma$).\footnote{Očekivana vrijednost slijedi iz parnosti funkcije oko
$x=\mu$, a varijansa se može odrediti primjenom parcijalne integracije.}

\begin{figure}[h]
  \centering
  \fig{0.31}{gauss_uni_std}{$\mu=0,\ \sigma^2=1$}{}
  \fig{0.31}{gauss_uni_deltamean}{$\mu=-2,\ \sigma^2=1$}{}
  \fig{0.31}{gauss_uni_deltavar}{$\mu=-2,\ \sigma^2=4$}{}
	\caption{Primjeri normalnih raspodjela sa različitim parametrima}
\end{figure}

\subsection{Multivarijabilna normalna raspodjela} \label{sec:gauss-multi}

Normalna raspodjela se može generalizirati i za vektore slučajnih varijabli.  Za
slučajni vektor $\bm X \in \mathbb{R}^k$ se kaže da je normalno raspodijeljen
ako je njegova funkcija gustine raspodjele:
%
\begin{equation} p_{\bm X}(\bm x) = \mathcal{N}(\bm\mu,\bm C_{\bm X\bm X}) =
\frac{1}{\sqrt{(2\pi)^k \det \bm C_{\bm X \bm X}}} e^{ -\frac{1}{2}(\bm x -
\bm\mu_{\bm X})^\text T \bm C_{\bm X \bm X}^{-1} (\bm x - \bm\mu_{\bm X}) }
\end{equation} Piše se $\bm X \sim \mathcal{N}(\bm\mu, \bm C_{\bm X\bm X})$.

Jedini uslov koji se postavlja na parametre ove raspodjele jeste da matrica
$\bm C_{\bm X\bm X}$ bude ispravna kovarijantna matrica, tj. da bude simetrična
i pozitivno semi-definitna.

\begin{theorem}
	\label{th:lin-tr-gauss}
	Neka je $\bm X \in \mathbb{R}^n$ normalno raspodijeljen slučajni vektor sa
	srednjom vrijednosti $\bm\mu_{\bm X}$ i kovarijantnom matricom $\bm C_{\bm
	X\bm X}$. Neka je $\bm A \in \mathbb{R}^{m\times n}$, $\bm b \in
	\mathbb{R}^n$, pri čemu je $m\le n$. Tada je vektor $\bm Y = \bm A \bm X + \bm
	b$ također normalno raspodijeljen sa srednjom vrijednosti $\bm\mu_{\bm Y} =
	\bm A\bm\mu_{\bm X} + \bm b$ i kovarijantnom matricom $\bm C_{\bm Y\bm Y} =
	\bm A \bm C_{\bm X\bm X} \bm A^\mathrm T$.

\end{theorem}

Jednostavnije rečeno, svaka linearna transformacija Gaussovog vektora uz
eventualnu translaciju, ponovo daje Gaussov vektor.

\begin{corollary}
	Svaki podvektor normalno raspodijeljenog slučajnog vektora $\bm X$ je također
	normalno raspodijeljen. Drugim riječima, sve marginalne pdf slučajnog
	vektora $\bm X$ su također normalne raspodjele.
\end{corollary}

Ovo je lako pokazati. Naime, neki podvektor $\bm Y = [X_{i_1}\ X_{i_2}\ \cdots\
X_{i_m}]^\text T$ vektora $\bm X$ se može dobiti formiranjem matrice $\bm A$
koja u $j$ - tom redu sadrži jedinicu na poziciji $i_j$, dok su ostali elementi
jednaki nuli. Za vektor $\bm b$ se uzima nul-vektor.  Parametri raspodjele
novodobijenog vektora se jednostavno određuju primjenom teorema
\ref{th:lin-tr-gauss}. Ovaj princip će biti ilustrovan na vektoru dvije slučajne
varijable kroz sljedeći primjer.

\begin{exmp}
	Neka je data normalna raspodjela $p_{\bm X}(\bm x) = p_{X_1,X_2}(x_1, x_2) =
	\mathcal{N}(\bm\mu, \bm \Sigma)$. Odrediti marginalne pdf $p_{X_1}(x)$ i
	$p_{X_2}(x)$.
\end{exmp}

Neka je:

\begin{eqnarray} \label{eq:kovarijansa-2d}
	\bm\mu = \left[\begin{array}{c}
		\mu_1 \\ \mu_2
	\end{array}\right],\ 
	\bm\Sigma = \left[\begin{array}{cc}
	  \sigma_1^2 & \rho\sigma_1\sigma_2 \\  \rho\sigma_1\sigma_2 & \sigma_2^2
	\end{array}\right]
\end{eqnarray}

Slučajne varijable $X_1$ i $X_2$ se mogu zapisati na sljedeći način:
\begin{eqnarray}
	X_1 = \vecrow{1}{0} \veccol{X_1}{X_2} = \bm A_1 \bm X,
	\\
	X_2 = \vecrow{0}{1} \veccol{X_1}{X_2} = \bm A_2 \bm X,
\end{eqnarray}

Primjenom teoreme \ref{th:lin-tr-gauss} se zaključuje da će $p_{X_1}$ i
$p_{X_2}$ također biti normalne raspodjele:

\begin{align*}
	p_{X_1} &= \mathcal{N}(\bm A_1\bm\mu, \bm A_1 \bm\Sigma \bm A_1^\mathrm T)
		= \mathcal{N}(\mu_1, \sigma_1^2) \\
	p_{X_2} &= \mathcal{N}(\bm A_2\bm\mu, \bm A_2 \bm\Sigma \bm A_2^\mathrm T)
		= \mathcal{N}(\mu_2, \sigma_2^2)
\end{align*}

Posmatrajući zapis \eqref{eq:kovarijansa-2d} jasno je da je $\rho$ Pearsonov
korelacioni koeficijent koji predstavlja mjeru koreliranosti između slučajnih
varijabli slučajnog vektora $\bm X$.

Na slici \ref{fig:gauss2} su prikazane dvodimenzionalne normalne pdf za neke
karakteristične vrijednosti kovarijantne matrice. Također su prikazane i
marginalne pdf koje su skalirane po visini radi jasnijeg prikaza.

\begin{figure}[H]
  \centering
  \fig{0.31}{gauss_multi_std}{$\bm\mu=\bm 0,\ \bm C_{\bm X\bm X} = \bm I$}{fig:gauss2a}
  \fig{0.31}{gauss_multi_corr+}{$\rho = 0.6$}{fig:gauss2b}
  \fig{0.31}{gauss_multi_corr-}{$\rho = -0.6$}{fig:gauss2c}
  \fig{0.31}{gauss_multi_corr1}{$\sigma_1^2=1, \sigma_2^2=5, \rho \approx 1$}{fig:gauss2d}
  \fig{0.31}{gauss_multi_y}{$\sigma_1^2=1,\ \sigma_2^2=5, \rho=0$}{fig:gauss2e}
  \fig{0.31}{gauss_multi_xcorr-}{$\sigma_1^2=4, \sigma_2^2=1, \rho=0.6$}{fig:gauss2f}
	\caption{Primjeri normalnih raspodjela sa različitim parametrima}
	\label{fig:gauss2}
\end{figure}

Na slici \ref{fig:gauss2a} je prikazana standardna normalna raspodjela sa nultom
srednjom vrijednosti i jediničnom kovarijantnom matricom. Raspodjela na slici
\ref{fig:gauss2b} je izmijenjena tako da su varijable negativno korelirane. Na
slici \ref{fig:gauss2c} je ova koreliranost ista po modulu, ali negativna. Na
slici \ref{fig:gauss2b} je prikazana normalna raspodjela pri čemu su varijable
maksimalno pozitivno korelirane. Na slici \ref{fig:gauss2e} je prikazana
normalna raspodjela nekoreliranog slučajnog vektora, kod kojeg je varijansa
slučajne varijable $X_2$ veća nego kod varijable $X_1$. Konačno, na slici
\ref{fig:gauss2f} je prikazana normalna raspodjela sa pozitivnom korelacijom,
pri čemu je varijansa varijable $X_1$ veća nego kod varijable $X_2$.\\

\noindent
Dolazi se do sljedećih zaključaka:
\begin{enumerate}
	\item Povećavanjem varijanse neke varijable dolazi do "razvlačenja" raspodjele
		po odgovarajućoj koordinati
	\item Povećanjem koreliranosti varijabli dolazi do koncentracije raspodjele
		oko pravca koji zavisi od kovarijantne matrice.
\end{enumerate}

\begin{corollary}
  Suma Gaussovih varijabli ponovo predstavlja Gaussovu varijablu. Ako su ove
  varijable nezavisne sa raspodjelama $\mathcal{N}(\mu_i, \sigma_i^2)$,
  $i=1,...,n$, njihova suma će imati raspodjelu
  $\mathcal{N}(\sum_{i=1}^{n}\mu_i, \sum_{i=1}^{n}\sigma_i^2)$.\footnote{
    Može se dokazati uzimanjem $\bm A = \left[
        \begin{array}{cccc}
          1 & 1 & \cdots & 1
        \end{array}\right]$
    i primjenom teorema \ref{th:lin-tr-gauss} na vektor od $n$ nezavisnih
    Gaussovih slučajnih varijabli.
  }
\end{corollary}

